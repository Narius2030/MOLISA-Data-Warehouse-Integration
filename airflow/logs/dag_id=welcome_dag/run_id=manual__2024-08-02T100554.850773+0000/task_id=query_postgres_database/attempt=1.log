[2024-08-02T10:06:45.352+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-08-02T10:06:45.390+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: welcome_dag.query_postgres_database manual__2024-08-02T10:05:54.850773+00:00 [queued]>
[2024-08-02T10:06:45.407+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: welcome_dag.query_postgres_database manual__2024-08-02T10:05:54.850773+00:00 [queued]>
[2024-08-02T10:06:45.408+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-08-02T10:06:45.443+0000] {taskinstance.py:2330} INFO - Executing <Task(SQLExecuteQueryOperator): query_postgres_database> on 2024-08-02 10:05:54.850773+00:00
[2024-08-02T10:06:45.448+0000] {standard_task_runner.py:63} INFO - Started process 2125 to run task
[2024-08-02T10:06:45.451+0000] {standard_task_runner.py:90} INFO - Running: ['airflow', 'tasks', 'run', 'welcome_dag', 'query_postgres_database', 'manual__2024-08-02T10:05:54.850773+00:00', '--job-id', '105', '--raw', '--subdir', 'DAGS_FOLDER/welcome_dag.py', '--cfg-path', '/tmp/tmpidaa239q']
[2024-08-02T10:06:45.454+0000] {standard_task_runner.py:91} INFO - Job 105: Subtask query_postgres_database
[2024-08-02T10:06:45.534+0000] {task_command.py:426} INFO - Running <TaskInstance: welcome_dag.query_postgres_database manual__2024-08-02T10:05:54.850773+00:00 [running]> on host 24fc876e8f70
[2024-08-02T10:06:45.678+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='welcome_dag' AIRFLOW_CTX_TASK_ID='query_postgres_database' AIRFLOW_CTX_EXECUTION_DATE='2024-08-02T10:05:54.850773+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-08-02T10:05:54.850773+00:00'
[2024-08-02T10:06:45.679+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-08-02T10:06:45.695+0000] {sql.py:276} INFO - Executing: /***
	Chèn dữ liệu khu vực trên cả nước
***/


INSERT INTO locations.region(region_code, region_name) VALUES
('01', 'Đồng bằng sông Hồng'),
('02', 'Trung du và miền núi phía Bắc'),
('03', 'Bắc Trung bộ và duyên hải miền Trung'),
('04', 'Tây Nguyên'),
('05', 'Đông Nam Bộ'),
('06', 'Đồng bằng sông Cửu Long'),
('07', 'Thành phố thuộc trung ương');



/***
	Chèn dữ liệu thành phố
***/


INSERT INTO locations.province(province_code, province_name, region_code) VALUES
('01', 'Hà Nội', '07'),
('02', 'Hà Giang', '02'),
('04', 'Cao Bằng', '02'),
('06', 'Bắc Kạn', '02'),
('08', 'Tuyên Quang', '02'),
('10', 'Lào Cai', '02'),
('11', 'Điện Biên', '02'),
('12', 'Lai Châu', '02'),
('14', 'Sơn La', '02'),
('15', 'Yên Bái', '02'),
('17', 'Hoà Bình', '02'),
('19', 'Thái Nguyên', '02'),
('20', 'Lạng Sơn', '02'),
('22', 'Quảng Ninh', '01'),
('24', 'Bắc Giang', '02'),
('25', 'Phú Thọ', '02'),
('26', 'Vĩnh Phúc', '01'),
('27', 'Bắc Ninh', '01'),
('30', 'Hải Dương', '01'),
('31', 'Hải Phòng', '07'),
('33', 'Hưng Yên', '01'),
('34', 'Thái Bình', '01'),
('35', 'Hà Nam', '01'),
('36', 'Nam Định', '01'),
('37', 'Ninh Bình', '01'),
('38', 'Thanh Hóa', '03'),
('40', 'Nghệ An', '03'),
('42', 'Hà Tĩnh', '03'),
('44', 'Quảng Bình', '03'),
('45', 'Quảng Trị', '03'),
('46', 'Thừa Thiên Huế', '03'),
('48', 'Đà Nẵng', '07'),
('49', 'Quảng Nam', '03'),
('51', 'Quảng Ngãi', '03'),
('52', 'Bình Định', '03'),
('54', 'Phú Yên', '03'),
('56', 'Khánh Hòa', '03'),
('58', 'Ninh Thuận', '03'),
('60', 'Bình Thuận', '03'),
('62', 'Kon Tum', '04'),
('64', 'Gia Lai', '04'),
('66', 'Đắk Lắk', '04'),
('67', 'Đắk Nông', '04'),
('68', 'Lâm Đồng', '04'),
('70', 'Bình Phước', '05'),
('72', 'Tây Ninh', '05'),
('74', 'Bình Dương', '05'),
('75', 'Đồng Nai', '05'),
('77', 'Bà Rịa - Vũng Tàu', '05'),
('79', 'Hồ Chí Minh', '07'),
('80','Long An', '06'),
('82','Tiền Giang', '06'),
('83','Bến Tre', '06'),
('84','Trà Vinh', '06'),
('86','Vĩnh Long', '06'),
('87','Đồng Tháp', '06'),
('89','An Giang', '06'),
('91','Kiên Giang', '06'),
('92','Cần Thơ', '07'),
('93','Hậu Giang', '06'),
('94','Sóc Trăng', '06'),
('95','Bạc Liêu', '06'),
('96','Cà Mau', '06');



/***
	Chèn dữ liệu các Quận/Huyện
***/


INSERT INTO locations.district(district_code, district_name, province_code) VALUES
('660', 'Gia Nghĩa', '67'),
('661', 'Đăk Glong', '67'),
('662', 'Cư Jút', '67'),
('663', 'Đắk Mil', '67'),
('664', 'Krông Nô', '67'),
('665', 'Đắk Song', '67'),
('666', 'Đắk R''Lấp', '67'),
('667', 'Tuy Đức', '67');



/***
	Chèn dữ liệu các Phường/Xã
***/


INSERT INTO locations.ward(ward_code, ward_name, district_code) VALUES
('24640', 'Ea T''Ling', '662'),
('24643', 'Đắk Wil', '662'),
('24646', 'Ea Pô', '662'),
('24649', 'Nam Dong', '662'),
('24652', 'Đắk DRông', '662'),
('24655', 'Tâm Thắng', '662'),
('24658', 'Cư Knia', '662'),
('24661', 'Trúc Sơn', '662'),
('24664','Đắk Mil', '663'),
('24667','Đắk Lao', '663'),
('24670','Đắk R''La', '663'),
('24673','Đắk Gằn', '663'),
('24676','Đức Mạnh', '663'),
('24688','Đắk Mâm', '664'),
('24691','Đắk Sôr', '664'),
('24692','Nam Xuân', '664'),
('24694','Buôn Choah', '664'),
('24697','Nam Đà', '664');



/*** 
	Chèn dữ liệu vào bảng quản lý các Năm
***/


INSERT INTO public.periods(years, start_date, end_date) VALUES
(2021, '08-31-2021', '01-01-2022'),
(2022, '01-09-2022', '01-02-2023'),
(2023, '01-09-2023', '01-02-2024'),
(2024, '01-09-2024', '01-02-2025');



/*** 
	Chèn dữ liệu vào bảng quản lý Tài sản
***/

INSERT INTO items.asset(asset_code, asset_name) VALUES
('A001', 'ô tô'),
('A002', 'ti vi màu'),
('A003', 'máy giặt, sấy quần áo'),
('A004', 'xe máy, xe có động cơ'),
('A005', 'dàn nghe nhạc các loại'),
('A006', 'bình tắm nước nóng'),
('A007', 'tàu thuyền có động cơ'),
('A008', 'máy vi tính/máy tính bảng'),
('A009', 'lò vi sóng, lò nướng'),
('A010', 'máy phát điện'),
('A011', 'tủ lạnh'),
('A012', 'điện thoại cố định/di động'),
('A013', 'máy in, máy fax'),
('A014', 'máy điều hòa nhiệt độ');



/*** 
	Chèn dữ liệu vào bảng quản lý Động vật chăn nuôi
***/


INSERT INTO items.animal(animal_code, animal_name) VALUES
('AN001', 'số lượng trâu, bò, ngựa'),
('AN002', 'số lượng lợn, dê, cừu'),
('AN003', 'số lượng gà/vịt/ngan/ngỗng/chim'),
('AN004', 'khác');



/*** 
	Chèn dữ liệu vào bảng quản lý Đất đai
***/


INSERT INTO items.land(land_code, land_name) VALUES
('L001', 'diện tích ao, vườn liền kề đất ở'),
('L002', 'diện tích trồng cây hằng năm'),
('L003', 'diện tích đất cây lâu năm'),
('L004', 'diện tích mặt nước'),
('L005', 'diện tích đất rừng');



/*** 
	Chèn dữ liệu vào bảng quản lý Những nguyên nhân khó khăn
***/


INSERT INTO items.hard_reasons(reason_code, reason) VALUES
('HR001', 'không có đất sản xuất'),
('HR002', 'không có công cụ/phương tiện sản xuất'),
('HR003', 'có người ốm đau, bệnh nặng'),
('HR004', 'không có vốn'),
('HR005', 'không biết làm ăn'),
('HR006', 'không có lao động'),
('HR007', 'không có kỹ năng lao động sản xuất'),
('HROTHER', 'khác');



/*** 
	Chèn dữ liệu vào bảng quản lý Những chính sách hỗ trợ
***/


INSERT INTO items.support_policies(policy_code, policy_name) VALUES
('CS001', 'hỗ trợ y tế'),
('CS002', 'hỗ trợ giáo dục'),
('CS003', 'hỗ trợ học nghề'),
('CS004', 'hỗ trợ việc làm'),
('CS005', 'hỗ trợ nhà ở'),
('CS006', 'hỗ trợ nước sạch và vệ sinh môi trường'),
('CS007', 'hỗ trợ đất sản xuất'),
('CS008', 'hỗ trợ vay vốn tín dụng'),
('CS009', 'hỗ trợ sản xuất, sinh kế'),
('CS010', 'hỗ trợ tiếp cận thông tin'),
('CS011', 'hỗ trợ pháp lý'),
('CS012', 'hỗ trợ tiền điện'),
('CSOTHER', 'khác');



/*** 
	Chèn dữ liệu vào bảng quản lý Những Cơ Sở Vật Chất của Hộ
***/


INSERT INTO items.facilities(facility_code, facility_name) VALUES
('B1S01M01', 'bê tông cốt thép'),
('B1S01M02', 'gạch đá'),
('B1S01M03', 'sắt/thép/gỗ bền chắc'),
('B1S01OTHER', 'khác'),
('B1S02M01', 'bê tông cốt thép'),
('B1S02M02', 'ngói'),
('B1S02M03', 'tấm hợp kim loại chuyên dụng'),
('B1S02OTHER', 'khác'),
('B1S03M01', 'bê tông cốt thép'),
('B1S03M02', 'gạch/đá'),
('B1S03M03', 'gỗ/kim loại bền chắc'),
('B1S03OTHER', 'khác'),
('B1S05M01', 'tự hoại/bán tự hoại'),
('B1S05M02', 'thấm dội nước (Suilabh), hố xí đào có bệ ngồi, hai ngăn'),
('B1S05OTHER', 'khác'),
('B1S06M01', 'điện lưới'),
('B1S06M02', 'điện máy phát'),
('B1S06M03', 'loại điện khác'),
('B1S06M04', 'chưa có điện'),
('B1S07M01', 'nước máy, nước đóng chai/bình, nước mua'),
('B1S07M02', 'nước giếng khoan'),
('B1S07M03', 'nước giếng đào được bảo vệ, nước khe/mó được bảo vệ'),
('B1S07OTHER', 'khác');







[2024-08-02T10:06:45.710+0000] {base.py:84} INFO - Using connection ID 'postgres_default' for task execution.
[2024-08-02T10:06:45.811+0000] {base.py:84} INFO - Using connection ID 'postgres_default' for task execution.
[2024-08-02T10:06:45.867+0000] {sql.py:470} INFO - Running statement: /***
	Chèn dữ liệu khu vực trên cả nước
***/


INSERT INTO locations.region(region_code, region_name) VALUES
('01', 'Đồng bằng sông Hồng'),
('02', 'Trung du và miền núi phía Bắc'),
('03', 'Bắc Trung bộ và duyên hải miền Trung'),
('04', 'Tây Nguyên'),
('05', 'Đông Nam Bộ'),
('06', 'Đồng bằng sông Cửu Long'),
('07', 'Thành phố thuộc trung ương');



/***
	Chèn dữ liệu thành phố
***/


INSERT INTO locations.province(province_code, province_name, region_code) VALUES
('01', 'Hà Nội', '07'),
('02', 'Hà Giang', '02'),
('04', 'Cao Bằng', '02'),
('06', 'Bắc Kạn', '02'),
('08', 'Tuyên Quang', '02'),
('10', 'Lào Cai', '02'),
('11', 'Điện Biên', '02'),
('12', 'Lai Châu', '02'),
('14', 'Sơn La', '02'),
('15', 'Yên Bái', '02'),
('17', 'Hoà Bình', '02'),
('19', 'Thái Nguyên', '02'),
('20', 'Lạng Sơn', '02'),
('22', 'Quảng Ninh', '01'),
('24', 'Bắc Giang', '02'),
('25', 'Phú Thọ', '02'),
('26', 'Vĩnh Phúc', '01'),
('27', 'Bắc Ninh', '01'),
('30', 'Hải Dương', '01'),
('31', 'Hải Phòng', '07'),
('33', 'Hưng Yên', '01'),
('34', 'Thái Bình', '01'),
('35', 'Hà Nam', '01'),
('36', 'Nam Định', '01'),
('37', 'Ninh Bình', '01'),
('38', 'Thanh Hóa', '03'),
('40', 'Nghệ An', '03'),
('42', 'Hà Tĩnh', '03'),
('44', 'Quảng Bình', '03'),
('45', 'Quảng Trị', '03'),
('46', 'Thừa Thiên Huế', '03'),
('48', 'Đà Nẵng', '07'),
('49', 'Quảng Nam', '03'),
('51', 'Quảng Ngãi', '03'),
('52', 'Bình Định', '03'),
('54', 'Phú Yên', '03'),
('56', 'Khánh Hòa', '03'),
('58', 'Ninh Thuận', '03'),
('60', 'Bình Thuận', '03'),
('62', 'Kon Tum', '04'),
('64', 'Gia Lai', '04'),
('66', 'Đắk Lắk', '04'),
('67', 'Đắk Nông', '04'),
('68', 'Lâm Đồng', '04'),
('70', 'Bình Phước', '05'),
('72', 'Tây Ninh', '05'),
('74', 'Bình Dương', '05'),
('75', 'Đồng Nai', '05'),
('77', 'Bà Rịa - Vũng Tàu', '05'),
('79', 'Hồ Chí Minh', '07'),
('80','Long An', '06'),
('82','Tiền Giang', '06'),
('83','Bến Tre', '06'),
('84','Trà Vinh', '06'),
('86','Vĩnh Long', '06'),
('87','Đồng Tháp', '06'),
('89','An Giang', '06'),
('91','Kiên Giang', '06'),
('92','Cần Thơ', '07'),
('93','Hậu Giang', '06'),
('94','Sóc Trăng', '06'),
('95','Bạc Liêu', '06'),
('96','Cà Mau', '06');



/***
	Chèn dữ liệu các Quận/Huyện
***/


INSERT INTO locations.district(district_code, district_name, province_code) VALUES
('660', 'Gia Nghĩa', '67'),
('661', 'Đăk Glong', '67'),
('662', 'Cư Jút', '67'),
('663', 'Đắk Mil', '67'),
('664', 'Krông Nô', '67'),
('665', 'Đắk Song', '67'),
('666', 'Đắk R''Lấp', '67'),
('667', 'Tuy Đức', '67');



/***
	Chèn dữ liệu các Phường/Xã
***/


INSERT INTO locations.ward(ward_code, ward_name, district_code) VALUES
('24640', 'Ea T''Ling', '662'),
('24643', 'Đắk Wil', '662'),
('24646', 'Ea Pô', '662'),
('24649', 'Nam Dong', '662'),
('24652', 'Đắk DRông', '662'),
('24655', 'Tâm Thắng', '662'),
('24658', 'Cư Knia', '662'),
('24661', 'Trúc Sơn', '662'),
('24664','Đắk Mil', '663'),
('24667','Đắk Lao', '663'),
('24670','Đắk R''La', '663'),
('24673','Đắk Gằn', '663'),
('24676','Đức Mạnh', '663'),
('24688','Đắk Mâm', '664'),
('24691','Đắk Sôr', '664'),
('24692','Nam Xuân', '664'),
('24694','Buôn Choah', '664'),
('24697','Nam Đà', '664');



/*** 
	Chèn dữ liệu vào bảng quản lý các Năm
***/


INSERT INTO public.periods(years, start_date, end_date) VALUES
(2021, '08-31-2021', '01-01-2022'),
(2022, '01-09-2022', '01-02-2023'),
(2023, '01-09-2023', '01-02-2024'),
(2024, '01-09-2024', '01-02-2025');



/*** 
	Chèn dữ liệu vào bảng quản lý Tài sản
***/

INSERT INTO items.asset(asset_code, asset_name) VALUES
('A001', 'ô tô'),
('A002', 'ti vi màu'),
('A003', 'máy giặt, sấy quần áo'),
('A004', 'xe máy, xe có động cơ'),
('A005', 'dàn nghe nhạc các loại'),
('A006', 'bình tắm nước nóng'),
('A007', 'tàu thuyền có động cơ'),
('A008', 'máy vi tính/máy tính bảng'),
('A009', 'lò vi sóng, lò nướng'),
('A010', 'máy phát điện'),
('A011', 'tủ lạnh'),
('A012', 'điện thoại cố định/di động'),
('A013', 'máy in, máy fax'),
('A014', 'máy điều hòa nhiệt độ');



/*** 
	Chèn dữ liệu vào bảng quản lý Động vật chăn nuôi
***/


INSERT INTO items.animal(animal_code, animal_name) VALUES
('AN001', 'số lượng trâu, bò, ngựa'),
('AN002', 'số lượng lợn, dê, cừu'),
('AN003', 'số lượng gà/vịt/ngan/ngỗng/chim'),
('AN004', 'khác');



/*** 
	Chèn dữ liệu vào bảng quản lý Đất đai
***/


INSERT INTO items.land(land_code, land_name) VALUES
('L001', 'diện tích ao, vườn liền kề đất ở'),
('L002', 'diện tích trồng cây hằng năm'),
('L003', 'diện tích đất cây lâu năm'),
('L004', 'diện tích mặt nước'),
('L005', 'diện tích đất rừng');



/*** 
	Chèn dữ liệu vào bảng quản lý Những nguyên nhân khó khăn
***/


INSERT INTO items.hard_reasons(reason_code, reason) VALUES
('HR001', 'không có đất sản xuất'),
('HR002', 'không có công cụ/phương tiện sản xuất'),
('HR003', 'có người ốm đau, bệnh nặng'),
('HR004', 'không có vốn'),
('HR005', 'không biết làm ăn'),
('HR006', 'không có lao động'),
('HR007', 'không có kỹ năng lao động sản xuất'),
('HROTHER', 'khác');



/*** 
	Chèn dữ liệu vào bảng quản lý Những chính sách hỗ trợ
***/


INSERT INTO items.support_policies(policy_code, policy_name) VALUES
('CS001', 'hỗ trợ y tế'),
('CS002', 'hỗ trợ giáo dục'),
('CS003', 'hỗ trợ học nghề'),
('CS004', 'hỗ trợ việc làm'),
('CS005', 'hỗ trợ nhà ở'),
('CS006', 'hỗ trợ nước sạch và vệ sinh môi trường'),
('CS007', 'hỗ trợ đất sản xuất'),
('CS008', 'hỗ trợ vay vốn tín dụng'),
('CS009', 'hỗ trợ sản xuất, sinh kế'),
('CS010', 'hỗ trợ tiếp cận thông tin'),
('CS011', 'hỗ trợ pháp lý'),
('CS012', 'hỗ trợ tiền điện'),
('CSOTHER', 'khác');



/*** 
	Chèn dữ liệu vào bảng quản lý Những Cơ Sở Vật Chất của Hộ
***/


INSERT INTO items.facilities(facility_code, facility_name) VALUES
('B1S01M01', 'bê tông cốt thép'),
('B1S01M02', 'gạch đá'),
('B1S01M03', 'sắt/thép/gỗ bền chắc'),
('B1S01OTHER', 'khác'),
('B1S02M01', 'bê tông cốt thép'),
('B1S02M02', 'ngói'),
('B1S02M03', 'tấm hợp kim loại chuyên dụng'),
('B1S02OTHER', 'khác'),
('B1S03M01', 'bê tông cốt thép'),
('B1S03M02', 'gạch/đá'),
('B1S03M03', 'gỗ/kim loại bền chắc'),
('B1S03OTHER', 'khác'),
('B1S05M01', 'tự hoại/bán tự hoại'),
('B1S05M02', 'thấm dội nước (Suilabh), hố xí đào có bệ ngồi, hai ngăn'),
('B1S05OTHER', 'khác'),
('B1S06M01', 'điện lưới'),
('B1S06M02', 'điện máy phát'),
('B1S06M03', 'loại điện khác'),
('B1S06M04', 'chưa có điện'),
('B1S07M01', 'nước máy, nước đóng chai/bình, nước mua'),
('B1S07M02', 'nước giếng khoan'),
('B1S07M03', 'nước giếng đào được bảo vệ, nước khe/mó được bảo vệ'),
('B1S07OTHER', 'khác');






, parameters: None
[2024-08-02T10:06:45.920+0000] {sql.py:479} INFO - Rows affected: 23
[2024-08-02T10:06:45.923+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-08-02T10:06:45.939+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=welcome_dag, task_id=query_postgres_database, run_id=manual__2024-08-02T10:05:54.850773+00:00, execution_date=20240802T100554, start_date=20240802T100645, end_date=20240802T100645
[2024-08-02T10:06:45.989+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-08-02T10:06:46.023+0000] {taskinstance.py:3498} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-08-02T10:06:46.033+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
